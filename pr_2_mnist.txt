# a) Import packages
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import matplotlib.pyplot as plt



# b) Load the training and testing data (MNIST) 
# MNIST = 28x28 images of handwritten digits (0–9)
(x_train ,y_train),(x_test ,y_test) = keras.datasets.mnist.load_data()

x_train.shape
y_train.shape
x_test.shape
y_test.shape


# Normalize pixel values (convert 0–255 → 0–1 range)
x_train = x_train/255.0
x_test = x_test/255.0


# Flatten 28x28 images → 784 values (for Feed Forward NN)
x_train = x_train.reshape(-1,28*28)
x_test = x_test.reshape(-1,28*28)



# c. Define the network architecture using Keras
model = keras.Sequential([
    layers.Dense(128,activation="relu",input_shape = (784,)),
    layers.Dense(64,activation = "tanh"),
    layers.Dense(10,activation = "softmax")
])



# d. Train the model using SGD
model.compile(optimizer = "sgd",
             loss = "sparse_categorical_crossentropy",
             metrics = ['accuracy'])

# Train the model
history = model.fit(x_train,y_train,epochs = 8,batch_size = 32,validation_split = 0.1)


# # e) Evaluate the network
test_loss,test_acc = model.evaluate(x_test,y_test)
print("test accuracy: ",test_acc)
print("test loss: ",test_loss)



# f) Plot the training loss and accuracy
# plot loss
plt.plot(history.history['loss'],label = 'train_loss')
plt.plot(history.history['val_loss'],label = 'validation loss')
plt.title('training and validation loss')
plt.xlabel('epochs')
plt.ylabel('Loss')
plt.legend()



# plot accuracy
plt.plot(history.history['accuracy'],label = 'train  accuracy')
plt.plot(history.history['val_accuracy'],label = 'validation accuracy')
plt.title('training and validation accuracy')
plt.xlabel('epochs')
plt.ylabel('Accuracy')
plt.legend()



# loss and accuracy
plt.plot(history.history['accuracy']) 
plt.plot(history.history['val_accuracy'])
plt.plot(history.history['loss']),
plt.plot(history.history['val_loss'])
plt.title("training loss and accuracy")
plt.ylabel('accuracy/Loss')
plt.xlabel('epoch')
plt.legend(['accuracy','val_accuracy','loss','val_loss'])



#matshow() stands for matrix show.
#It visualizes a 2D array (matrix) as an image — each number (pixel value) in the matrix is represented by a color.
plt.matshow(x_train[0],cmap='jet')